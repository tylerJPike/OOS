<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>OOS, and easy start • OOS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="OOS, and easy start">
<meta property="og:description" content="OOS">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">OOS</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown-header">
      </ul>
<ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-cogs"></span>
     
    Workflow
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Articles</li>
    <li class="dropdown-header">1. Data Cleaning</li>
    <li class="dropdown-header">2. Forecasting</li>
    <li class="dropdown-header">3. Error Analysis</li>
    <li class="dropdown-header">4. Charting</li>
    <li class="divider">
    <li class="dropdown-header">Vignettes</li>
    <li>
      <a href=".././articles/getting_started.html">1. Getting Starting</a>
    </li>
    <li class="dropdown-header">2. User-Defined Methods</li>
    <li class="dropdown-header">3. Binary Outcomes</li>
    <li class="dropdown-header">4. Dimension Reduction</li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    <span class="fa fa-cog"></span>
     
    Tools
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href=".././articles/data_cleaning.html">Data Cleaning Techniques</a>
    </li>
    <li>
      <a href=".././articles/forecast_techniques.html">Forecasting Techniques</a>
    </li>
    <li>
      <a href=".././articles/error_analysis.html">Error Analysis Techniques</a>
    </li>
    <li class="divider">
    <li>
      <a href=".././reference/index.html">Function Documentation</a>
    </li>
  </ul>
</li>
<li>
  <a href="https://github.com/tylerJPike/OOS">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="getting_started_files/header-attrs-2.5/header-attrs.js"></script><link href="getting_started_files/anchor-sections-1.0/anchor-sections.css" rel="stylesheet">
<script src="getting_started_files/anchor-sections-1.0/anchor-sections.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>OOS, and easy start</h1>
            
      
      
      <div class="hidden name"><code>getting_started.Rmd</code></div>

    </div>

    
    
<p>In this simple vignette, we will get started with a simple forecasting example of interest to many people, the unemployment rate of the United States. We will proceed by 1) downloading economic data from FRED, 2) creating a collection of univariate and multivariate forecasts, 3) combining all our forecasts to create new, and hopefully more accurate, forecasts, 4) evaluate our forecast errors and, 5) visualize our most promising forecasts.</p>
<p><em>Disclaimer: this writing is meant to be a simple example highlighting the workflow of the OOS package. That being said, the US macroeconomy is an erdogic system, a fact that is ignored for this analysis. As a result, there are several important steps to the time series analysis ignored and this should not be taken as advice on how to forecast the US unemployment rate for any type of actionable decision making.</em></p>
<div id="environment" class="section level2">
<h2 class="hasAnchor">
<a href="#environment" class="anchor"></a>0. Environment</h2>
<p>For the purposes of this vignette, we will load the general purpose tidyverse for data cleaning and the OOS package for forecasting. However, note that <strong>OOS does not require tidyverse be loaded globally</strong>, this is purely for the ease of exposition.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load packages</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="http://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/message.html">suppressPackageStartupMessages</a></span><span class="op">(</span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org">lubridate</a></span><span class="op">)</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">OOS</span><span class="op">)</span></code></pre></div>
</div>
<div id="data" class="section level2">
<h2 class="hasAnchor">
<a href="#data" class="anchor"></a>1. Data</h2>
<p>As we are are seeking to forecast the unemployment rate, we will obviously need to beging by acquiring the time series data. Moreover, as we will be taking advantage of multivariate techniques, we will also look towards aquiring related economic time series, namely industrial production (as a monthly proxy for output), and the 10-year constant maturity Treasury yield (as a proxy for interest rates).</p>
<p>For our data we will turn to <a href="https://fred.stlouisfed.org/">FRED</a> (a repository of global economic data, currated by the Federal Reserve Bank of St. Louis).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># pull data </span>
<span class="fu">quantmod</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/quantmod/man/getSymbols.FRED.html">getSymbols.FRED</a></span><span class="op">(</span>
    <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'UNRATE'</span>,<span class="st">'INDPRO'</span>,<span class="st">'GS10'</span><span class="op">)</span>, 
    env <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/environment.html">globalenv</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'quantmod':
##   method            from
##   as.zoo.data.frame zoo</code></pre>
<pre><code>## [1] "UNRATE" "INDPRO" "GS10"</code></pre>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># format data </span>
<span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span><span class="va">UNRATE</span>, <span class="va">INDPRO</span>, <span class="va">GS10</span><span class="op">)</span> 
<span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span><span class="va">Data</span>, date <span class="op">=</span> <span class="fu">zoo</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/index.html">index</a></span><span class="op">(</span><span class="va">Data</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<p>One will note that once we downloaded the data from FRED, we additionally combine all of the series into a data.frame with a column named <code>date</code>. We do this because OOS forecasting routines can accept two general data formats.</p>
<ol style="list-style-type: decimal">
<li>a standard R time series object, including <code>ts</code>, <code>xts</code>, or <code>zoo</code> objects</li>
<li>a generic data.frame with only one requirement, there is a date column named “date”, used to index the forecasting data (as this is non-standard, it is what we demonstrate in this vignette).</li>
</ol>
<p>Then, before we move on to the fun part, we will inspect our new data.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic plot of the unemployment time series </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">UNRATE</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic plot of the industrial production time series </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">INDPRO</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-3-2.png" width="700"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># basic plot of the 10-year Treasury yield time series </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">GS10</span><span class="op">)</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-3-3.png" width="700"></p>
<p>Upon inspection it becomes clear that industrial production and the 10-year Treasury yield are trending series (i.e. they are non-stationary). And yes, there are formal tests we could conduct to test this hypothesis, as well as with the unemployment rate, but for the purposes of this example we will take their trends, or lack thereof, as given. We will transform the industrial production to a year-over-year percent growth rate and the 10-year Treasury yield to a month-over-month percentage point change.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># make industrial production and 10-year Treasury stationary</span>
<span class="va">Data</span> <span class="op">=</span> <span class="va">Data</span> <span class="op">%&gt;%</span>
  <span class="fu">mutate</span><span class="op">(</span>GS10 <span class="op">=</span> <span class="va">GS10</span> <span class="op">-</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/lead-lag.html">lag</a></span><span class="op">(</span><span class="va">GS10</span><span class="op">)</span>, 
         INDPRO <span class="op">=</span> <span class="op">(</span><span class="va">INDPRO</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">INDPRO</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/lag.html">lag</a></span><span class="op">(</span><span class="va">INDPRO</span>, <span class="fl">12</span><span class="op">)</span><span class="op">)</span> 

<span class="co"># start data when all three variables are available</span>
<span class="co"># (this is not necessary, but it will suppress warnings for us)</span>
<span class="va">Data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/filter.html">filter</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">date</span> <span class="op">&gt;=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'1954-01-01'</span><span class="op">)</span><span class="op">)</span></code></pre></div>
</div>
<div id="create-forecasts" class="section level2">
<h2 class="hasAnchor">
<a href="#create-forecasts" class="anchor"></a>2. Create Forecasts</h2>
<div id="univariate-forecasts" class="section level3">
<h3 class="hasAnchor">
<a href="#univariate-forecasts" class="anchor"></a>2.1 Univariate Forecasts</h3>
<p>We will first forecast using a collection of univariate time series. As we have chosen to forecast a very clean series, we will not make use of OOS’s ability to <strong>clean outliers</strong> and <strong>impute missing values</strong> in a real-time fashion. That is, we only need to focus on the bare bone requirements of OOS’s univariate forecasting routine, <code>forecast_univariate</code>:</p>
<ol style="list-style-type: decimal">
<li>Data: a <code>ts</code>, <code>xts</code>, or <code>zoo</code> time series object, or a two column data.frame with a <code>date</code> column and the time series to forecast<br>
</li>
<li>forecast.dates: a vector of dates on which to simulate a historical forecast<br>
</li>
<li>method: a vector of forecast method names (see the package website for a list of currently supported methods)<br>
</li>
<li>horizon: an integer denoting how far into the future (measured in periods) to forecast<br>
</li>
<li>recursive: a boolean denoting if forecasts to a horizon greater than one should be conducted recursively with one-step-ahead forecasts or via direct projection (the default is recursive forecasting)</li>
<li>rolling.window: an integer denoting the number of backward looking periods to use when training the forecasting model (if NA then the entire available history will be used)<br>
</li>
<li>freq: a string denoting the frequency of the time series being forecasted</li>
</ol>
<p>For our demonstration, we will simulate forecasts of the unemployment rate one month into the future, using a random walk, ARIMA, and exponential smoothing, over a five year period from 2015 through 2019.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># run univariate forecasts</span>
<span class="va">forecast.uni</span> <span class="op">=</span>
    <span class="fu"><a href="../reference/forecast_univariate.html">forecast_univariate</a></span><span class="op">(</span>
        <span class="co"># forecasting data</span>
      Data <span class="op">=</span> <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">date</span>, <span class="va">UNRATE</span><span class="op">)</span>,
        forecast.dates <span class="op">=</span>
          <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2015-01-01'</span><span class="op">)</span>,
                   to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2019-12-01-01'</span><span class="op">)</span>,
                   by <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span>,

        <span class="co"># forecast method and type</span>
        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'naive'</span>,<span class="st">'auto.arima'</span>, <span class="st">'ets'</span><span class="op">)</span>,
        horizon <span class="op">=</span> <span class="fl">1</span>,
        recursive <span class="op">=</span> <span class="cn">FALSE</span>,

        <span class="co"># information set treatment</span>
        rolling.window <span class="op">=</span> <span class="cn">NA</span>,
        freq <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span></code></pre></div>
<pre><code>## &lt;warning: univariate.forecast.training was instantiated and default values will be used for model estimation.&gt;</code></pre>
<p>One may notice that after running <code>forecast_univariate</code> we received the warning:</p>
<pre><code>&lt;warning: univariate.forecast.training was instantiated and default values will be used for model estimation.&gt;</code></pre>
<p>This warns us that we are using default parameters when training the random walk, ARIMA, and exponential smoothing models. More on this topic, including how a user may change the training parameters as they would like, will be covered in a separate vignette - as such, this type of warning will be suppressed for the remainder of the exercise. We next examine our output.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># view top of forecast output</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">forecast.uni</span><span class="op">)</span></code></pre></div>
<pre><code>##        model forecast        se forecast.date       date
## 1      naive 5.700000 0.1917706    2015-01-01 2015-02-01
## 2 auto.arima 5.653460 0.1796099    2015-01-01 2015-02-01
## 3        ets 5.653691 0.1790950    2015-01-01 2015-02-01
## 4      naive 5.500000 0.1917821    2015-02-01 2015-03-01
## 5 auto.arima 5.474782 0.1795762    2015-02-01 2015-03-01
## 6        ets 5.477820 0.1790102    2015-02-01 2015-03-01</code></pre>
<p>As one can see, we now have five years worth of one-month ahead forecasts for the US unemployment rate! The default output for OOS forecasting routines, <code>forecast_univariate</code>, <code>forecast_multivariate</code>, and <code>forecast_combination</code>, is a long form matrix with the columns:</p>
<ol style="list-style-type: decimal">
<li>model: a string naming the model used to estimate the forecast<br>
</li>
<li>forecast: a numeric forecast<br>
</li>
<li>se: a numeric standard error, NA when models do not generate standard errors by default<br>
</li>
<li>forecast.date: a date denoting the day the forecast was (simulated) made<br>
</li>
<li>date: a date denoting the day being foretasted</li>
</ol>
<p>Note that when forecasts are generated recursively for a horizon greater than one, all forecasts between forecast.date and date will be provided in the forecast output as well as the declared horizon.</p>
</div>
<div id="multivariate-forecasts" class="section level3">
<h3 class="hasAnchor">
<a href="#multivariate-forecasts" class="anchor"></a>2.2 Multivariate Forecasts</h3>
<p>Having successfully created a pool of univariate forecasts, we next turn to a collection of multivariate forecasting models. While there are several similarities in univariate and multivariate forecasting in OOS, one will will note that there are four differences between key <code>forecast_univariate</code> and <code>forecast_multivariate</code>.</p>
<ol style="list-style-type: decimal">
<li>
<code>forecast_multivariate</code> requires one to declare the name of the variable to be forecasted.</li>
<li>
<code>forecast_multivariate</code> allows the user to create an arbitrary number of lags for a chosen set (although the default is all) of variables in the design matrix.</li>
<li>
<code>forecast_univariate</code> allows the user to use direct projections or recursive forecasting while <code>forecast_multivariate</code> only allows for direct projections (this may change in a future version of OOS).</li>
<li>
<code>forecast_multivariate</code> allows users to perform dimension reduction on a chosen set (although the default is all) of variables in the design matrix, via principal components.</li>
</ol>
<p>With these differences in mind, we will jump right into our multivariate forecasting with <code>forecast_multivariate</code>.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create multivariate forecasts</span>
<span class="va">forecast.multi</span> <span class="op">=</span> 
    <span class="fu"><a href="../reference/forecast_multivariate.html">forecast_multivariate</a></span><span class="op">(</span>
        Data <span class="op">=</span> <span class="va">Data</span>,           
        forecast.date <span class="op">=</span> 
          <span class="fu"><a href="https://rdrr.io/r/base/seq.Date.html">seq.Date</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2015-01-01'</span><span class="op">)</span>,
                   to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html">as.Date</a></span><span class="op">(</span><span class="st">'2019-12-01'</span><span class="op">)</span>,
                   by <span class="op">=</span> <span class="st">'month'</span><span class="op">)</span>,
        target <span class="op">=</span> <span class="st">'UNRATE'</span>,
        
        <span class="co"># forecast method and type</span>
        horizon <span class="op">=</span> <span class="fl">1</span>,
        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'ols'</span>,<span class="st">'elastic'</span>,<span class="st">'RF'</span><span class="op">)</span>,

        <span class="co"># information set treatment       </span>
        rolling.window <span class="op">=</span> <span class="cn">NA</span>,    
        freq <span class="op">=</span> <span class="st">'month'</span>, 
        lag.n <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>    </code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># view top of forecast output</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">forecast.multi</span><span class="op">)</span></code></pre></div>
<pre><code>##         date forecast.date   model forecast         se
## 1 2015-02-01    2015-01-01     ols 5.697031 0.03688140
## 2 2015-02-01    2015-01-01 elastic 5.699710         NA
## 3 2015-02-01    2015-01-01      RF 5.541870         NA
## 4 2015-03-01    2015-02-01     ols 5.958763 0.04550295
## 5 2015-03-01    2015-02-01 elastic 5.945148         NA
## 6 2015-03-01    2015-02-01      RF 5.550913         NA</code></pre>
<p>And it appears that we again have been successful in forecasting the US unemployment rate!</p>
</div>
<div id="forecast-combinations" class="section level3">
<h3 class="hasAnchor">
<a href="#forecast-combinations" class="anchor"></a>2.3 Forecast Combinations</h3>
<p>It is no secret that while one forecast can be good, several forecasts can be great. we next turn to combining forecasts through a series of (out-of-sample) forecast combination techniques using the OOS <code>forecast_combine</code> function.</p>
<p>To create a set of forecast combinations, we will first need to merge our existing forecasts into one data.frame. Additionally, as we will use combination methods that require minimizing a loss function, we will also merge in the true data realizations - although this is not necessary when a user relies on methods that do not need to learn (e.g. uniform weights or the forecast median).</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># combine forecasts and add in observed values</span>
<span class="va">forecasts</span> <span class="op">=</span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span>
        <span class="va">forecast.uni</span>,
        <span class="va">forecast.multi</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">left_join</a></span><span class="op">(</span> 
        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">Data</span>, <span class="va">date</span>, observed <span class="op">=</span> <span class="va">UNRATE</span><span class="op">)</span>,
        by <span class="op">=</span> <span class="st">'date'</span><span class="op">)</span></code></pre></div>
<p>Now that we have our forecasts all in one neat package, we may turn to creating forecast combinations.</p>
<p>Two things that a user may wish to note regarding the <code>forecast_combine</code> function are:</p>
<ol style="list-style-type: decimal">
<li>
<code>forecast_combine</code> is designed to specifically take in output from <code>forecast_univariate</code> and <code>forecast_multivariate</code>, however, if as long as a user has their data formatted in the same long-form style as the OOS forecasting functions, they can use <code>forecast_combine</code>.<br>
</li>
<li>When using any methods that require training, a user must specify a number of burn in observations, that is, the number of observations to use in the first model instantiation.</li>
</ol>
<p>Bearing these notes in mind, we will use a collection of naive methods, uniform weights, the median forecast, and a winsorized mean, as well as a collection of trained combination models, n.best, LASSO, and peLASSO, with a burn in of 5 observations to combine our univariate and multivariate based forecasts.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># forecast combinations </span>
<span class="va">forecast.combo</span> <span class="op">=</span> 
    <span class="fu"><a href="../reference/forecast_combine.html">forecast_combine</a></span><span class="op">(</span>
        <span class="va">forecasts</span>, 
        method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'uniform'</span>,<span class="st">'median'</span>,<span class="st">'trimmed.mean'</span>,
                       <span class="st">'n.best'</span>,<span class="st">'lasso'</span>,<span class="st">'peLasso'</span><span class="op">)</span>, 
        burn.in <span class="op">=</span> <span class="fl">5</span>, 
        n.max <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>

<span class="co"># merge forecast combinations back into forecasts</span>
<span class="co"># (these will be used later)</span>
<span class="va">forecasts</span> <span class="op">=</span> 
    <span class="va">forecasts</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/bind.html">bind_rows</a></span><span class="op">(</span><span class="va">forecast.combo</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># view top of forecast output</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">forecast.combo</span><span class="op">)</span></code></pre></div>
<pre><code>##         date forecast   model se
## 1 2015-02-01 5.657627 uniform NA
## 2 2015-03-01 5.651238 uniform NA
## 3 2015-04-01 5.528927 uniform NA
## 4 2015-05-01 5.474600 uniform NA
## 5 2015-06-01 5.547554 uniform NA
## 6 2015-07-01 5.504483 uniform NA</code></pre>
<p>We have forecast combinations for the US unemployment rate! This is nice progress, but now that we have all of these forecasts, how do we know which ones are good and which ones we should use to make decisions?</p>
<p>For that we next turn to OOS’s suite of forecast evaluation metrics.</p>
</div>
</div>
<div id="forecast-evaluation" class="section level2">
<h2 class="hasAnchor">
<a href="#forecast-evaluation" class="anchor"></a>3. Forecast Evaluation</h2>
<p>Now that we have a collection of forecasts, we would like to know which ones to use. OOS has two ways to evaluate forecasts, error analysis and visualization.</p>
<div id="error-analysis" class="section level3">
<h3 class="hasAnchor">
<a href="#error-analysis" class="anchor"></a>3.1 Error analysis</h3>
<p>First, we can calculate various loss functions for each model found in a long-form data.frame in the same style as <code>forecast_univariate</code>, <code>forecast_multivariate</code>, and <code>forecast_combine</code> output.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># calculate forecast errors</span>
<span class="va">forecast.error</span> <span class="op">=</span> <span class="fu"><a href="../reference/forecast_accuracy.html">forecast_accuracy</a></span><span class="op">(</span><span class="va">forecasts</span><span class="op">)</span>

<span class="co"># view forecast errors from least to greatest </span>
<span class="co">#   (best forecast to worst forecast method)</span>
<span class="va">forecast.error</span> <span class="op">%&gt;%</span> 
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">MSE</span><span class="op">)</span></code></pre></div>
<pre><code>## # A tibble: 14 x 5
##    model          MSE  RMSE   MAE  MAPE
##    &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
##  1 N.best       0.009 0.092 0.074 0.017
##  2 N1           0.009 0.096 0.075 0.017
##  3 N2           0.009 0.097 0.08  0.018
##  4 RF           0.01  0.101 0.078 0.018
##  5 peLasso      0.012 0.11  0.092 0.021
##  6 lasso        0.014 0.12  0.083 0.019
##  7 median       0.014 0.12  0.095 0.022
##  8 auto.arima   0.016 0.128 0.107 0.024
##  9 ets          0.016 0.128 0.107 0.024
## 10 naive        0.016 0.126 0.103 0.024
## 11 trimmed.mean 0.023 0.153 0.126 0.029
## 12 uniform      0.023 0.153 0.126 0.029
## 13 ols          0.091 0.301 0.253 0.059
## 14 elastic      0.098 0.313 0.265 0.062</code></pre>
<p>Through comparing errors we can see that the N-best forecast combination outperformed the rest of the pack, while the random forest was the best performing single forecast, and the simple ARIMA and ETS models outperform all other multivariate methods. Moreover, we can additionally comparing forecasts in statistical tests or error ratios. Here we see how all of our forecasts compare to a baseline random walk, where an error ratio smaller than one signals that a forecast method has a smaller error (that is, does better) than the random walk.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># compare forecasts to the baseline (a random walk)</span>
<span class="fu"><a href="../reference/forecast_comparison.html">forecast_comparison</a></span><span class="op">(</span>
    <span class="va">forecasts</span>,
    baseline.forecast <span class="op">=</span> <span class="st">'naive'</span>,  
    test <span class="op">=</span> <span class="st">'ER'</span>,
    loss <span class="op">=</span> <span class="st">'MSE'</span><span class="op">)</span> <span class="op">%&gt;%</span> 
    <span class="fu">arrange</span><span class="op">(</span><span class="va">error.ratio</span><span class="op">)</span> <span class="op">%&gt;%</span>
    <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate_all.html">mutate_at</a></span><span class="op">(</span><span class="fu">vars</span><span class="op">(</span><span class="op">-</span><span class="va">model</span><span class="op">)</span>, <span class="va">round</span>, <span class="fl">3</span><span class="op">)</span></code></pre></div>
<pre><code>##           model error.ratio
## 1        N.best       0.534
## 2            N1       0.580
## 3            N2       0.590
## 4            RF       0.639
## 5       peLasso       0.775
## 6        median       0.893
## 7         lasso       0.919
## 8         naive       1.000
## 9           ets       1.021
## 10   auto.arima       1.022
## 11 trimmed.mean       1.461
## 12      uniform       1.461
## 13          ols       5.661
## 14      elastic       6.136</code></pre>
<p>Then, after comparing forecasts based on errors, we can visualize our output.</p>
</div>
<div id="visualizing-forecasts" class="section level3">
<h3 class="hasAnchor">
<a href="#visualizing-forecasts" class="anchor"></a>3.2 Visualizing Forecasts</h3>
<p>Lamentably, current OOS charting capabilities are somewhat limited, but this will change in future versions of the package. For now, we will focus our attention on our forecasts themselves.</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># chart forecasts</span>
    <span class="va">chart</span> <span class="op">=</span> 
        <span class="fu"><a href="../reference/forecast_chart.html">forecast_chart</a></span><span class="op">(</span>
            <span class="va">forecasts</span>,              
            Title <span class="op">=</span> <span class="st">'US Unemployment Rate'</span>,
            Ylab <span class="op">=</span> <span class="st">'Percent'</span>,
            Freq <span class="op">=</span> <span class="st">'Monthly'</span><span class="op">)</span>

    <span class="va">chart</span></code></pre></div>
<p><img src="getting_started_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
</div>
</div>
<div id="conclusion" class="section level2">
<h2 class="hasAnchor">
<a href="#conclusion" class="anchor"></a>Conclusion</h2>
<p>During our brief walk through the basic OOS workflow, we have successfully created out-of-sample forecasts for the US unemployment rate over a five year period using univariate, multivariate, and ensemble methods. Then we were able to compare these methods and discern that while forecast combinations were on whole the best performing class of forecasts, the simple ARIMA, ETS, and random walk all did very well in comparison to the pool of multivariate models (save the random forest).</p>
<p>Through this exercise we have demonstrated just how easy OOS makes it to test times series forecasting methods in pseudo-real time. However, this walk through only touches on the surface level capabilities of OOS, please see additional articles and vignettes for a deeper dive into user-defined forecasting methods, additional possible output, and real-time dimension reduction techniques, among other topics.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Tyler J. Pike.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
